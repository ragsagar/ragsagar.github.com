<!DOCTYPE html>
<html lang="en">
<head>
        
        <meta charset="utf-8" />
        <title>r4g54g4r's h4ckl0g</title>
        
        <link href="ragsagar.in/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="r4g54g4r's h4ckl0g Atom Feed" />
        
        
        
        <link href="ragsagar.in/feeds/django, Howtos, Python.atom.xml" type="application/atom+xml" rel="alternate" title="r4g54g4r's h4ckl0g Categories Atom Feed" />
        
        
        
        
        
        
        <link rel="stylesheet" href="/theme/css/style.css" type="text/css">
        
</head>

<body>
<div class=container>

    <div class=header>
        <a href="./about.html">r4g54g4r's h4ckl0g</a>
    </div>

    <div class=navigation>
        <ul>
            
        </ul>
    </div>
</div>
<div class=body>

        <!---->
          <!---->
        <!---->
        <!--</ul></nav>[> /#menu <]-->
        
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="making-a-field-in-a-django-admin-form-visible-or-invisible-depending-on-the-user.html" rel="bookmark"
         title="Permalink to Making a field in a django admin form visible or invisible depending on the user">Making a field in a django admin form visible or invisible depending on the user</a></h2>
  </header>
  <footer class="post-info">
    <abbr class="published" title="2012-05-09T22:52:00">
      Wed 09 May 2012
    </abbr>
    
    <address class="vcard author">
      By <a class="url fn" href="./author/rag-sagarv.html">Rag Sagar.V</a>
    </address>
    
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>While i was working on the project <a class="reference external" href="https://github.com/ragsagar/onspot_v2">onspot_v2</a>, i came across with a
specific need. <a class="reference external" href="https://github.com/ragsagar/onspot_v2">onspot_v2</a> makes use of the django admin interface for
data entry. When employees are entering data, 'branch' field in the form
will get populated automatically as per the branch of the employee. When
a manager is entering data using the form, an extra field should appear
to select the 'branch' instead of automatically populating. Googling
didn't help much. Finally i thought of overriding the
<a class="reference external" href="https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.add_view">ModelAdmin.add_view()</a> method which is invoked when you try to add an
entry using the admin. I changed the editable property of the field
'branch' inside after checking the request.user and it worked out. Part
of my code in admin.py [sourcecode language=&quot;python&quot;] from
django.contrib import admin from books.models import Agent, PolicyIssue
class PolicyIssueAdmin(admin.ModelAdmin): def add_view(self, request,
form_url='', extra_context=None): if
request.user.get_profile().is_employee:
self.model.branch.field.editable = False else:
self.model.branch.field.editable = True return super(PolicyIssueAdmin,
self).add_view(request, form_url) admin.site.register(PolicyIssue,
PolicyIssueAdmin) [/sourcecode]</p>

  </div><!-- /.entry-content -->
</section>


        <!--  #footer -->
        
            <div class=footer>
                
                    <p>&copy; Copyright 2012 by Rag Sagar.V.
                
                
                
                    Contact me via
                    
                    <a href=http://twitter.com/ragsagar>Twitter</a>
                    
                    <a href=http://facebook.com/ragsagar>Facebook</a>
                    
                    <a href=http://github.com/ragsagar>Github</a>
                    
                    <a href=http://flickr.com/ragsagar>Flickr</a>
                    
                
            </div>
        

        <!--<footer id="contentinfo" class="body">-->
                <!--<address id="about" class="vcard body">-->
                <!--Proudly powered by <a href="http://getpelican.com/">Pelican</a>,-->
                <!--which takes great advantage of <a href="http://python.org">Python</a>.-->
                <!--</address>[> /#about <]-->
        <!--</footer>[> /#contentinfo <]-->
</div>
</body>
</html>