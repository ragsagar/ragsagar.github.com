<!DOCTYPE html>
<html lang="en">
<head>
        <title>r4g54g4r's h4ckl0g - RTC</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href=".././theme/css/main.css" type="text/css" />
        <link href=".././" type="application/atom+xml" rel="alternate" title="r4g54g4r's h4ckl0g ATOM Feed" />
        


        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie.css"/>
                <script src=".././js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">

<a href="http://github.com/ragsagar">

<img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />

</a>

        <header id="banner" class="body">
                <h1><a href=".././index.html">r4g54g4r's h4ckl0g </a></h1>
                <nav><ul>
                
                
                <li><a href=".././index.html">Home</a></li>
                
                
                
                </ul></nav>
        </header><!-- /#banner -->

        


    
     <section id="content" class="body">
        <aside id="featured"><article>
                <h1 class="entry-title"><a href=".././how-to-automatically-wake-up-your-computer-at-a-particular-time-resume-by-rtc-alarm-in-arch-linux.html">How to automatically wake up your computer at a particular time ( Resume by RTC alarm in Arch Linux )</a></h1>
                <footer class="post-info">
        <abbr class="published" title="2011-08-15T14:04:00">
                Mon 15 August 2011
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/rag-sagarv.html">Rag Sagar.V</a>
        </address>
        
<p>In <a href=".././category/howtos.html">Howtos</a>. </p>
<p>tags: <a href=".././tag/acpi.html">acpi</a><a href=".././tag/alarm.html">alarm</a><a href=".././tag/arch.html">arch</a><a href=".././tag/automatic-booting.html">automatic booting</a><a href=".././tag/automatic-wakeup.html">automatic wakeup</a><a href=".././tag/how-to.html">how-to</a><a href=".././tag/linux.html">linux</a><a href=".././tag/resume-by-rtc.html">resume by rtc</a><a href=".././tag/rtc.html">RTC</a><a href=".././tag/wakeup.html">wakeup</a></p>
</p>

</footer><!-- /.post-info --><!-- /.post-info -->
                <p>My ISP provides unlimited download from 2am to 8am. So i was not able to
sleep after 2 from the time i switched to the new broadband plan.
Keeping the system on and setting a cronjob to start downloading after 2
was an option. But i was more concerned about the increasing electricity
charge, than my sleep. Besides it is my social responsibility to save
energy as a gonna-be software engineer :p. After a bit of googling and
hacking i was able to wake up my system at a particular time. Here i am
going to explain how i made my arch linux system to boot automatically
at 2 am. The configuration is done in Arch Linux. For automatic wakeup
it needs a BIOS which supports RTC alarm. Most of them manufactured
after 2000 supports this feature.</p>
<div class="section" id="check-if-your-bios-supports-automatic-wakeup">
<h2>1) Check if your BIOS supports automatic wakeup</h2>
<p>Execute the command below as root. [sourcecode language=&quot;text&quot;]# grep
rtc /var/log/messages.log rtc_cmos 00:03: RTC can wake from S4 rtc0:
alarms up to one month [/sourcecode] If you can find something like this
in the output.It says that the system can wakeup and a wakeup time can
be setup.</p>
</div>
<div class="section" id="enable-automatic-wakeup-in-bios">
<h2>2) Enable automatic wakeup in BIOS</h2>
<p>Go to your BIOS setup, Under Power Management search for something like
&quot;Wake by RTC Alarm&quot; or &quot;Resume by RTC alarm&quot; or &quot;RTC resume&quot;.Then enable
it.</p>
</div>
<div class="section" id="set-the-hardware-clock-time-standard-as-utc">
<h2>3) Set the hardware clock time standard as UTC</h2>
<p>Edit the /etc/rc.conf file as root and set the HARDWARECLOCK variable to
UTC [sourcecode language=&quot;text&quot;][<a class="reference external" href="mailto:ragsagar&#64;h4ckb0x">ragsagar&#64;h4ckb0x</a> ~]$ grep
^HARDWARECLOCK /etc/rc.conf HARDWARECLOCK=&quot;UTC&quot;[/sourcecode] Make sure
that your timezone is set correctly in /etc/rc.conf More help :
<a class="reference external" href="https://wiki.archlinux.org/index.php/Time">https://wiki.archlinux.org/index.php/Time</a></p>
</div>
<div class="section" id="set-the-alarm-time">
<h2>4) Set the alarm time</h2>
<p>Execute the following commands as root [sourcecode language=&quot;text&quot;]#
echo 0 &gt; /sys/class/rtc/rtc0/wakealarm # echo `date '+%s' -d '+ 5
minutes'` &gt; /sys/class/rtc/rtc0/wakealarm [/sourcecode] This will set
the the alarm time as 5 minutes into the future. <a href="#id1"><span class="problematic" id="id2">`|image0|`_</span></a> Now run
[sourcecode language=&quot;text&quot;]$ cat
/sys/class/rtc/rtc0/wakealarm[/sourcecode] If the output of above
command is something like &quot;1313383930&quot;, the alarm is set. It is epoch
time. If it doesn't yield any result make sure that the HARDWARECLOCK
variable is set to UTC and reboot and try again to set the alarm time.
Now run [sourcecode language=&quot;text&quot;]$ cat /proc/driver/rtc [/sourcecode]
<a href="#id3"><span class="problematic" id="id4">`|image1|`_</span></a> Go through rtc_time, alrm_time and alrm_date and check if
they are correct(will be in UTC).Turn off the system and leave the power
on. Check if the system is booting automatically after five mintues.</p>
</div>
<div class="section" id="setting-the-alarm-to-a-particular-time-and-date">
<h2>5) Setting the alarm to a particular time and date.</h2>
<p>To set the alarm to woke up the system at 16th Aug 2:05am, Run the
following as root [sourcecode language=&quot;text&quot;]# echo 0 &gt;
/sys/class/rtc/rtc0/wakealarm # date --date &quot;Aug 16 , 2011 02:05:00&quot; +%s
&gt; /sys/class/rtc/rtc0/wakealarm[/sourcecode] You can convert the epoch
time to readable format and check the alarm time is correct. [sourcecode
language=&quot;text&quot;][<a class="reference external" href="mailto:root&#64;h4ckb0x">root&#64;h4ckb0x</a> ragsagar]# cat
/sys/class/rtc/rtc0/wakealarm 1313440500 [<a class="reference external" href="mailto:root&#64;h4ckb0x">root&#64;h4ckb0x</a> ragsagar]# date
-d &#64;1313440500 +%F&quot; &quot;%T 2011-08-16 02:05:00 [/sourcecode] <a href="#id5"><span class="problematic" id="id6">`|image2|`_</span></a>
<strong>Note :</strong> The mythtv wiki about acpi wakeup says that setting the
hardware clock after setting alarm will disable the alarm while most of
the linux distribution sets hardware clock during shutdown. They suggest
to disable hardware clock adjusting during shutdown. To do that in
Archlinux set the HARDWARECLOCK=&quot;&quot; in /etc/rc.conf . But in my arch
system the alarm was not working when i set HARDWARECLOCK=&quot;&quot; whereas it
worked when i gave HARDWARECLOCK=&quot;UTC&quot;. So if the wake up alarm is not
working do try after changing the value of this variable. To start
downloading when the system boots up, i added a cronjob to <a class="reference external" href="http://ragsagar.wordpress.com/2011/08/13/script-to-reboot-teracom-router/">restart the
router</a> at 2:15 and 7:45 (to account the download in happy hours). Also
added &quot;transmission-gtk&quot; to the gnome-session-properties. So that
transmission will be launched on startup and downloading will be
started. <strong>Reference :</strong> <a class="reference external" href="http://www.mythtv.org/wiki/ACPI_Wakeup">http://www.mythtv.org/wiki/ACPI_Wakeup</a>
<a class="reference external" href="https://wiki.archlinux.org/index.php/Time">https://wiki.archlinux.org/index.php/Time</a></p>
</p></div>
<div class="system-messages section">
<h2>Docutils System Messages</h2>
<div class="system-message" id="id1">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">/home/ragsagar/Documents/myblog/content/how-to-automatically-wake-up-your-computer-at-a-particular-time-resume-by-rtc-alarm-in-arch-linux.rst</tt>, line 47); <em><a href="#id2">backlink</a></em></p>
Unknown target name: &quot;|image0|&quot;.</div>
<div class="system-message" id="id3">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">/home/ragsagar/Documents/myblog/content/how-to-automatically-wake-up-your-computer-at-a-particular-time-resume-by-rtc-alarm-in-arch-linux.rst</tt>, line 47); <em><a href="#id4">backlink</a></em></p>
Unknown target name: &quot;|image1|&quot;.</div>
<div class="system-message" id="id5">
<p class="system-message-title">System Message: ERROR/3 (<tt class="docutils">/home/ragsagar/Documents/myblog/content/how-to-automatically-wake-up-your-computer-at-a-particular-time-resume-by-rtc-alarm-in-arch-linux.rst</tt>, line 64); <em><a href="#id6">backlink</a></em></p>
Unknown target name: &quot;|image2|&quot;.</div>
</div>

        </article></aside><!-- /#featured -->
        
    

</ol><!-- /#posts-list -->
</section><!-- /#content -->



        <aside id="sidebar">
                <div class="widget">
                        <h2>Categories</h2>
                        <ul>
                        
                           <li ><a href=".././category/blog.html">Blog</a></li>
                        
                           <li ><a href=".././category/gnulinux-howtos.html">Gnu/Linux, Howtos</a></li>
                        
                           <li ><a href=".././category/gnulinux-howtos-python-scripts.html">Gnu/Linux, Howtos, Python, Scripts</a></li>
                        
                           <li ><a href=".././category/gnulinux-my-thoughts.html">Gnu/Linux, My Thoughts</a></li>
                        
                           <li ><a href=".././category/gnulinux-my_works-python-scripts.html">Gnu/Linux, My_Works, Python, Scripts</a></li>
                        
                           <li ><a href=".././category/gnulinux-my_works-python-scripts-shell-scripts.html">Gnu/Linux, My_Works, Python, Scripts, Shell Scripts</a></li>
                        
                           <li ><a href=".././category/gnulinux-scripts-shell-scripts.html">Gnu/Linux, Scripts, Shell Scripts</a></li>
                        
                           <li ><a href=".././category/howtos.html">Howtos</a></li>
                        
                           <li ><a href=".././category/howtos-python-scripts.html">Howtos, Python, Scripts</a></li>
                        
                           <li ><a href=".././category/my-thoughts.html">My Thoughts</a></li>
                        
                           <li ><a href=".././category/my_works-python-scripts.html">My_Works, Python, Scripts</a></li>
                        
                           <li ><a href=".././category/my_works-scripts.html">My_Works, Scripts</a></li>
                        
                           <li ><a href=".././category/python-scripts.html">Python, Scripts</a></li>
                        
                           <li ><a href=".././category/scripts.html">Scripts</a></li>
                        
                           <li ><a href=".././category/scripts-shell-scripts.html">Scripts, Shell Scripts</a></li>
                        
                           <li ><a href=".././category/uncategorized.html">Uncategorized</a></li>
                        
                           <li ><a href=".././category/django-howtos-python.html">django, Howtos, Python</a></li>
                        
                           <li ><a href=".././category/misc.html">misc</a></li>
                        
                        </ul>
                </div>
        
                <div class="widget blogroll">
                        <h2>Blogroll</h2>
                        <ul>
                        
                            <li><a href="http://docs.notmyidea.org/alexis/pelican/">Pelican</a></li>
                        
                            <li><a href="http://python.org">Python.org</a></li>
                        
                            <li><a href="http://ragsagar.wordpress.com">Wordpress Blog</a></li>
                        
                        </ul>
                </div><!-- /.blogroll -->
        
        
                <div class="widget social">
                        <h2>Social</h2>
                        <ul>
                            <li><a href=".././" rel="alternate">atom feed</a></li>
                            

                        
                            <li><a href="http://twitter.com/ragsagar">Twitter</a></li>
                        
                            <li><a href="http://facebook.com/ragsagar">Facebook</a></li>
                        
                            <li><a href="http://github.com/ragsagar">Github</a></li>
                        
                            <li><a href="http://flickr.com/ragsagar">Flickr</a></li>
                        
                        </ul>
                </div><!-- /.social -->
        
        </aside><!-- /#sidebar -->

        <footer id="footer" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>, which takes great advantages of <a href="http://python.org">python</a>.
                </address><!-- /#about -->

                <p>The theme is «notmyidea-cms», a modified version of «notmyidea», the default theme.</p>
        </footer><!-- /#footer -->


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-35491289-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>

</body>
</html>